@using PagedList;
@using PagedList.Mvc;

@model IPagedList<G16_2013.Models.MemberModel.Person>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="row">
    <div class="col-md-12">       
        <div class="panel panel-default">
            <div class="panel-body">
                  @* 條件搜尋 *@
                <h4>條件搜尋</h4>     
                <div class="row">
                    <form role="search" method="post" action="/Person/Index">                        
                        <div class="col-md-2">                       
                            <select class="form-control input-sm" id="searchway" name="searchway">
                                @foreach (var op in ViewBag.SearchWays)
                                {
                                    <option value="@op.Value">@op.Text</option>
                                }                                

                            </select>
                        </div>
                        @* 搜尋 *@
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-8" style="text-align: right">
                                    <label class="sr-only">搜尋關鍵字</label>
                                    <input type="text" class="form-control input-sm" placeholder="請輸入搜尋關鍵字" name="searchstr">
                                </div>
                                <div class="col-md-4">
                                    <button type="submit" class="btn btn-default btn-sm">搜尋</button>
                                </div>
                            </div>

                            <div class="form-group">
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <table class="table table-striped table-hover ">
            <thead>
                <tr>
                    <th>#</th>
                    <th><a href="~/Person/Index/?sortBy=@ViewBag.SortName" class="text-primary">姓名 <span class="glyphicon glyphicon-sort"></span></a>   @*@Html.ActionLink("姓名 ▼", "Index", new { sortBy = ViewBag.SortName, style = "color:#FF3300;font-size:20px;" }) *@</th>
                    <th>性別</th>
                    <th>手機</th>
                    <th>Email</th>
                    <th>帳號</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var p in Model)
                {                    
                    <tr>
                        <td></td>
                        <td><a href="~/Person/Detail?id=@p.PersonId" class="text-info">@p.Name</a></td>
                        <td>@DisplayGender(p.Gender)</td>
                        <td>@p.ContactInfo.Phone</td>
                        <td>@p.ContactInfo.Email</td>
                        <td>
                            @foreach (var c in p.Accounts.ToList())
                            {
                                @DisplayAccountType(Convert.ToInt32(c.AccountType))  
                                @c.AccountNumber @: &nbsp;
                            }
                        </td>
                    </tr>
                }

            </tbody>
        </table>


        @Html.PagedListPager(Model, Page => Url.Action("Index", new { Page, sortBy = Request["sortBy"] }),
        new PagedListRenderOptions
        {
            LinkToFirstPageFormat = "<< 第一頁",
            LinkToPreviousPageFormat = "< 上一頁",
            LinkToNextPageFormat = "下一頁 >",
            LinkToLastPageFormat = "最後一頁 >>",
            DisplayLinkToFirstPage = PagedListDisplayMode.Always,
            DisplayLinkToPreviousPage = PagedListDisplayMode.Always,
            DisplayLinkToNextPage = PagedListDisplayMode.Always,
            DisplayLinkToLastPage = PagedListDisplayMode.Always,
        })


    </div>
</div>


@helper DisplayGender(bool gender)
{
    if (gender)
    {
    @: 男   
      }
    else
    {
    @: 女    
      }  
}

@helper DisplayAccountType(int type)
{
    if (type == 0)
    {
        @: <span class="label label-info">期貨帳號</span>
    }else if(type==1){
        @: <span class="label label-danger">證券帳號</span>
    }else{
        @: <span class="label label-warning">基金帳號</span>
    }
}