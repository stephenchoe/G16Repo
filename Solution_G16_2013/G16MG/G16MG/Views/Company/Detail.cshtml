@model G16_2013.Models.MemberModel.CompanyViewModel

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@Html.DisplayForModel("Company/Company")

<div class="well">
    <button type="button" id="btnEditCompanyManager" class="btn btn-default btn-sm">變更聯絡人</button>
    <button type="button" id="btnAddCompanyContract" class="btn btn-default btn-sm">新增合約</button>
    <button type="button" id="btnAddAECode" class="btn btn-default btn-sm">新增業務代碼</button>
  
</div>

<div id="divOperating">
    @Html.Action("ReadCompanyManager", "Company",  new { id= Model.ManagerId})


</div>


<ul class="nav nav-tabs" style="margin-bottom: 15px;" id="ulDetail">

    <li class="active"><a href="#divAECodes" data-toggle="tab">業務代碼</a></li>

    <li><a href="#divContractRecords" data-toggle="tab">合約紀錄</a></li>
  
    <li><a href="#divAERecords" data-toggle="tab">AE紀錄</a></li>

   
</ul>
<div id="myTabContent" class="tab-content">
    <div class="tab-pane fade active in" id="divAECodes">
        @* 業務代碼 *@
        @Html.Action("ReadAECodes", "Company", new { companyId = Model.CompanyId })

    </div>

    <div class="tab-pane fades" id="divContractRecords">
        @* 合約紀錄 *@
        @Html.Action("ReadContractRecords", "Company", new { companyId = Model.CompanyId })
    </div>

    <div class="tab-pane fade" id="divAERecords">
        @* AE紀錄 *@
        @Html.Action("ReadAERecords", "Company", new { companyId = Model.CompanyId })

    </div>
   
</div>


@section Scripts{
    @if (TempData["message"] != null)
    {     
        @Html.Action("StatusAlert", "Base", new { status = TempData["message"] })     
    }
    @if (TempData["view"] != null)
        {
   <script type="text/javascript">
       var view = "@Html.Raw(Json.Encode(TempData["view"]))";

       $("#ulDetail li").each(function () { $(this).removeClass("active"); })
       $("#myTabContent").children().removeClass("active in");
       switch (view) {
           case "1":
               SwitchTabPage(1);
               break;
           case "2":
               SwitchTabPage(2);
               break;
           default:
               SwitchTabPage(0);
               break;
       }

       function SwitchTabPage(page) {
           $("#ulDetail li:eq(" + view + ")").addClass("active");
           $("#myTabContent").children(":eq(" + view + ")").addClass("active in");
       }
   </script>
}

    <script>
        $(document).ready(function () {
            var divToReplace = $("#divOperating");          
            var actionUrl = "";
            var type = "GET";

            //註冊按鈕
            $("#btnEditCompanyManager").click(function (e) {
                
                actionUrl = '@Url.Action("EditCompanyManager", "Company", new { id = Model.CompanyId })';

                AsyncUpdate(actionUrl, type, divToReplace);
            })

            $("#btnAddCompanyContract").click(function (e) {
               
                actionUrl = '@Url.Action("AddCompanyContract", "Company", new { companyId = Model.CompanyId })';

                AsyncUpdate(actionUrl, type, divToReplace);
            })

            $("#btnAddAECode").click(function (e) {

                actionUrl = '@Url.Action("AddAECode", "Company", new { companyId = Model.CompanyId })';

                AsyncUpdate(actionUrl, type, divToReplace);
            })

           

        })

    </script>



}